<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸš€ OrphiChain Live Dashboard - BSC Mainnet Integration</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --orphi-royal-purple: #7B2CBF;
            --orphi-cyber-blue: #00D4FF;
            --orphi-energy-orange: #FF6B35;
            --orphi-success-green: #00C851;
            --orphi-warning-yellow: #FFD700;
            --orphi-error-red: #FF4444;
            --orphi-dark-bg: #0A0A0A;
            --orphi-card-bg: rgba(255, 255, 255, 0.05);
            --orphi-border: rgba(255, 255, 255, 0.1);
            --orphi-text-primary: #FFFFFF;
            --orphi-text-secondary: #B0B0B0;
            --orphi-gradient-primary: linear-gradient(135deg, #7B2CBF 0%, #00D4FF 100%);
            --orphi-gradient-secondary: linear-gradient(135deg, #FF6B35 0%, #FFD700 100%);
            --orphi-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --orphi-shadow-hover: 0 12px 48px rgba(123, 44, 191, 0.4);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0A0A0A 0%, #1a1a2e 50%, #16213e 100%);
            color: var(--orphi-text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .ultimate-dashboard {
            min-height: 100vh;
            background: var(--orphi-dark-bg);
            position: relative;
        }

        .ultimate-dashboard::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(123, 44, 191, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 212, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(255, 107, 53, 0.05) 0%, transparent 50%);
            animation: backgroundShift 20s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes backgroundShift {
            0%, 100% { transform: translateX(0) translateY(0); }
            25% { transform: translateX(-20px) translateY(-10px); }
            50% { transform: translateX(20px) translateY(10px); }
            75% { transform: translateX(-10px) translateY(20px); }
        }

        .dashboard-header {
            background: var(--orphi-card-bg);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--orphi-border);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            font-size: 2rem;
            background: var(--orphi-gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: logoGlow 3s ease-in-out infinite;
        }

        @keyframes logoGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .dashboard-title {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--orphi-gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .status-badges {
            display: flex;
            gap: 0.5rem;
        }

        .badge {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.3rem;
            animation: badgePulse 2s ease-in-out infinite;
        }

        .badge.success {
            background: linear-gradient(45deg, var(--orphi-success-green), #00A040);
        }

        .badge.live {
            background: linear-gradient(45deg, var(--orphi-error-red), #CC3333);
            animation: liveBlink 1.5s ease-in-out infinite;
        }

        .badge.connected {
            background: linear-gradient(45deg, var(--orphi-cyber-blue), #0099CC);
        }

        .badge.warning {
            background: linear-gradient(45deg, var(--orphi-warning-yellow), #E6C200);
            color: #000;
        }

        @keyframes badgePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes liveBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .wallet-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--orphi-card-bg);
            border-radius: 10px;
            border: 1px solid var(--orphi-border);
        }

        .wallet-address {
            font-family: monospace;
            font-size: 0.9rem;
            color: var(--orphi-cyber-blue);
        }

        .connect-wallet-btn {
            background: var(--orphi-gradient-primary);
            border: none;
            border-radius: 10px;
            padding: 0.5rem 1rem;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .connect-wallet-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--orphi-shadow-hover);
        }

        .dashboard-container {
            padding: 2rem;
            max-width: 1600px;
            margin: 0 auto;
        }

        .notifications-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .notification {
            background: var(--orphi-card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--orphi-border);
            border-radius: 10px;
            padding: 1rem 1.5rem;
            color: var(--orphi-text-primary);
            box-shadow: var(--orphi-shadow);
            animation: slideInRight 0.3s ease-out;
            max-width: 350px;
            position: relative;
        }

        .notification.success {
            border-left: 4px solid var(--orphi-success-green);
        }

        .notification.error {
            border-left: 4px solid var(--orphi-error-red);
        }

        .notification.warning {
            border-left: 4px solid var(--orphi-warning-yellow);
        }

        .notification.info {
            border-left: 4px solid var(--orphi-cyber-blue);
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .main-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .metric-card {
            background: var(--orphi-card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--orphi-border);
            border-radius: 15px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--orphi-gradient-primary);
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--orphi-shadow-hover);
            border-color: var(--orphi-cyber-blue);
        }

        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .metric-title {
            font-size: 0.9rem;
            color: var(--orphi-text-secondary);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .metric-icon {
            font-size: 1.2rem;
        }

        .metric-value {
            font-size: 2.2rem;
            font-weight: 700;
            background: var(--orphi-gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            animation: valueUpdate 0.5s ease-out;
        }

        @keyframes valueUpdate {
            0% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .metric-subtitle {
            font-size: 0.8rem;
            color: var(--orphi-text-secondary);
        }

        .metric-trend {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            font-size: 0.8rem;
            margin-top: 0.5rem;
        }

        .trend-positive {
            color: var(--orphi-success-green);
        }

        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 15px;
            z-index: 100;
        }

        .loading-content {
            text-align: center;
            color: var(--orphi-text-primary);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--orphi-cyber-blue);
            animation: spin 1s ease-in-out infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .action-section {
            margin-bottom: 2rem;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .action-btn {
            background: var(--orphi-gradient-primary);
            border: none;
            border-radius: 10px;
            padding: 1rem 1.5rem;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--orphi-shadow-hover);
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .action-btn.secondary {
            background: var(--orphi-gradient-secondary);
        }

        .contract-info {
            background: var(--orphi-card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--orphi-border);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: var(--orphi-gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .contract-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .contract-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--orphi-border);
        }

        .contract-label {
            font-weight: 600;
            color: var(--orphi-text-secondary);
        }

        .contract-value {
            font-family: monospace;
            color: var(--orphi-cyber-blue);
            font-size: 0.9rem;
        }

        .status-live {
            color: var(--orphi-success-green);
            font-weight: 600;
        }

        .user-registration {
            background: var(--orphi-card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--orphi-border);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .registration-form {
            display: grid;
            gap: 1rem;
            max-width: 500px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-label {
            font-weight: 600;
            color: var(--orphi-text-secondary);
        }

        .form-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--orphi-border);
            border-radius: 8px;
            padding: 0.75rem;
            color: var(--orphi-text-primary);
            font-size: 0.9rem;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--orphi-cyber-blue);
            box-shadow: 0 0 0 2px rgba(0, 212, 255, 0.2);
        }

        .form-select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--orphi-border);
            border-radius: 8px;
            padding: 0.75rem;
            color: var(--orphi-text-primary);
            font-size: 0.9rem;
        }

        .package-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .package-option {
            background: rgba(123, 44, 191, 0.1);
            border: 2px solid rgba(123, 44, 191, 0.3);
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .package-option:hover {
            background: rgba(123, 44, 191, 0.2);
            transform: translateY(-2px);
        }

        .package-option.selected {
            border-color: var(--orphi-cyber-blue);
            background: rgba(0, 212, 255, 0.1);
        }

        .package-amount {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--orphi-cyber-blue);
            margin-bottom: 0.5rem;
        }

        .package-name {
            font-size: 0.8rem;
            color: var(--orphi-text-secondary);
        }

        @media (max-width: 1200px) {
            .dashboard-container {
                padding: 1rem;
            }
        }

        @media (max-width: 768px) {
            .dashboard-header {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
            }
            
            .header-right {
                width: 100%;
                justify-content: space-between;
            }
            
            .main-metrics {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .dashboard-container {
                padding: 0.5rem;
            }
            
            .metric-card {
                padding: 1rem;
            }
            
            .contract-info {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, useMemo } = React;

        // Contract Configuration - Real BSC Mainnet
        const CONTRACT_CONFIG = {
            address: "0x8F826B18096Dcf7AF4515B06Cb563475d189ab50",
            implementationAddress: "0xE9d76e821790c64d7563F6022b5F73eEAE57DB6C",
            network: "BSC Mainnet",
            chainId: 56,
            usdtAddress: "0x55d398326f99059fF775485246999027B3197955",
            rpcUrl: "https://bsc-dataseed.binance.org/",
            blockExplorer: "https://bscscan.com",
            contractUrl: "https://bscscan.com/address/0x8F826B18096Dcf7AF4515B06Cb563475d189ab50",
            writeContractUrl: "https://bscscan.com/address/0x8F826B18096Dcf7AF4515B06Cb563475d189ab50#writeContract"
        };

        // Package Configuration
        const PACKAGE_TIERS = {
            NONE: 0,
            PACKAGE_30: 1,
            PACKAGE_50: 2,
            PACKAGE_100: 3,
            PACKAGE_200: 4
        };

        const PACKAGE_AMOUNTS = {
            [PACKAGE_TIERS.PACKAGE_30]: "30000000",   // 30 USDT (6 decimals)
            [PACKAGE_TIERS.PACKAGE_50]: "50000000",   // 50 USDT
            [PACKAGE_TIERS.PACKAGE_100]: "100000000", // 100 USDT
            [PACKAGE_TIERS.PACKAGE_200]: "200000000"  // 200 USDT
        };

        // Simplified ABI for key functions
        const CONTRACT_ABI = [
            "function registerUser(address sponsor, uint8 packageTier) external",
            "function withdraw(uint256 amount) external",
            "function upgradePackage(uint8 newTier) external",
            "function getUserInfo(address user) external view returns (uint256 totalInvested, uint256 registrationTime, uint256 teamSize, uint256 totalEarnings, uint256 withdrawableAmount, uint8 packageTier, uint8 leaderRank, bool isCapped, bool isActive, address sponsor, uint32 directReferrals)",
            "function getPoolEarnings(address user) external view returns (uint128[5] memory)",
            "function getDirectReferrals(address user) external view returns (address[] memory)",
            "function getWithdrawalRate(address user) external view returns (uint256)",
            "function isUserRegistered(address user) external view returns (bool)",
            "function totalUsers() external view returns (uint256)",
            "function totalVolume() external view returns (uint256)",
            "function globalHelpPoolBalance() external view returns (uint256)",
            "function leaderBonusPoolBalance() external view returns (uint256)",
            "function getPackageAmounts() external view returns (uint256[4] memory)",
            "event UserRegistered(address indexed user, address indexed sponsor, uint8 indexed packageTier, uint256 amount, uint256 timestamp)",
            "event WithdrawalProcessed(address indexed user, uint256 indexed amount, uint256 reinvestmentAmount, uint256 timestamp)",
            "event CommissionDistributed(address indexed recipient, address indexed payer, uint256 indexed amount, uint8 poolType, string poolName, uint256 timestamp)"
        ];

        // Web3 Integration Hook
        const useWeb3 = () => {
            const [provider, setProvider] = useState(null);
            const [signer, setSigner] = useState(null);
            const [contract, setContract] = useState(null);
            const [account, setAccount] = useState(null);
            const [isConnected, setIsConnected] = useState(false);
            const [chainId, setChainId] = useState(null);
            const [error, setError] = useState(null);

            const connectWallet = useCallback(async () => {
                try {
                    if (!window.ethereum) {
                        throw new Error('MetaMask not found. Please install MetaMask.');
                    }

                    const accounts = await window.ethereum.request({
                        method: 'eth_requestAccounts'
                    });

                    const provider = new ethers.providers.Web3Provider(window.ethereum);
                    const signer = provider.getSigner();
                    const network = await provider.getNetwork();

                    // Check if we're on BSC Mainnet
                    if (network.chainId !== 56) {
                        try {
                            await window.ethereum.request({
                                method: 'wallet_switchEthereumChain',
                                params: [{ chainId: '0x38' }], // BSC Mainnet
                            });
                        } catch (switchError) {
                            if (switchError.code === 4902) {
                                await window.ethereum.request({
                                    method: 'wallet_addEthereumChain',
                                    params: [{
                                        chainId: '0x38',
                                        chainName: 'Binance Smart Chain',
                                        nativeCurrency: {
                                            name: 'BNB',
                                            symbol: 'BNB',
                                            decimals: 18
                                        },
                                        rpcUrls: ['https://bsc-dataseed.binance.org/'],
                                        blockExplorerUrls: ['https://bscscan.com/']
                                    }]
                                });
                            }
                        }
                    }

                    const contract = new ethers.Contract(CONTRACT_CONFIG.address, CONTRACT_ABI, signer);

                    setProvider(provider);
                    setSigner(signer);
                    setContract(contract);
                    setAccount(accounts[0]);
                    setChainId(network.chainId);
                    setIsConnected(true);
                    setError(null);

                    return { provider, signer, contract, account: accounts[0] };
                } catch (err) {
                    setError(err.message);
                    throw err;
                }
            }, []);

            const disconnectWallet = useCallback(() => {
                setProvider(null);
                setSigner(null);
                setContract(null);
                setAccount(null);
                setIsConnected(false);
                setChainId(null);
                setError(null);
            }, []);

            // Auto-connect if previously connected
            useEffect(() => {
                const checkConnection = async () => {
                    if (window.ethereum) {
                        try {
                            const accounts = await window.ethereum.request({
                                method: 'eth_accounts'
                            });
                            if (accounts.length > 0) {
                                await connectWallet();
                            }
                        } catch (err) {
                            console.error('Auto-connect failed:', err);
                        }
                    }
                };

                checkConnection();
            }, [connectWallet]);

            return {
                provider,
                signer,
                contract,
                account,
                isConnected,
                chainId,
                error,
                connectWallet,
                disconnectWallet
            };
        };

        // Notification System
        const useNotifications = () => {
            const [notifications, setNotifications] = useState([]);

            const addNotification = useCallback((message, type = 'info', duration = 5000) => {
                const id = Date.now();
                const notification = { id, message, type };
                
                setNotifications(prev => [...prev, notification]);

                if (duration > 0) {
                    setTimeout(() => {
                        setNotifications(prev => prev.filter(n => n.id !== id));
                    }, duration);
                }

                return id;
            }, []);

            const removeNotification = useCallback((id) => {
                setNotifications(prev => prev.filter(n => n.id !== id));
            }, []);

            return { notifications, addNotification, removeNotification };
        };

        // Main Dashboard Component
        const OrphiChainMainnetDashboard = () => {
            const web3 = useWeb3();
            const { notifications, addNotification } = useNotifications();
            const [userInfo, setUserInfo] = useState(null);
            const [contractStats, setContractStats] = useState(null);
            const [loading, setLoading] = useState(false);
            const [registrationForm, setRegistrationForm] = useState({
                sponsor: '',
                packageTier: PACKAGE_TIERS.PACKAGE_100
            });

            // Load user data when connected
            useEffect(() => {
                const loadUserData = async () => {
                    if (web3.isConnected && web3.contract && web3.account) {
                        setLoading(true);
                        try {
                            // Check if user is registered
                            const isRegistered = await web3.contract.isUserRegistered(web3.account);
                            
                            if (isRegistered) {
                                // Get user info
                                const userInfoResult = await web3.contract.getUserInfo(web3.account);
                                const poolEarnings = await web3.contract.getPoolEarnings(web3.account);
                                const withdrawalRate = await web3.contract.getWithdrawalRate(web3.account);
                                
                                setUserInfo({
                                    totalInvested: ethers.utils.formatUnits(userInfoResult.totalInvested, 6),
                                    registrationTime: userInfoResult.registrationTime.toNumber(),
                                    teamSize: userInfoResult.teamSize.toNumber(),
                                    totalEarnings: ethers.utils.formatUnits(userInfoResult.totalEarnings, 6),
                                    withdrawableAmount: ethers.utils.formatUnits(userInfoResult.withdrawableAmount, 6),
                                    packageTier: userInfoResult.packageTier,
                                    leaderRank: userInfoResult.leaderRank,
                                    isCapped: userInfoResult.isCapped,
                                    isActive: userInfoResult.isActive,
                                    sponsor: userInfoResult.sponsor,
                                    directReferrals: userInfoResult.directReferrals,
                                    poolEarnings: poolEarnings.map(earning => ethers.utils.formatUnits(earning, 6)),
                                    withdrawalRate: withdrawalRate.toNumber() / 10000 // Convert from basis points
                                });
                            }

                            // Get contract stats
                            const totalUsers = await web3.contract.totalUsers();
                            const totalVolume = await web3.contract.totalVolume();
                            const globalHelpPool = await web3.contract.globalHelpPoolBalance();
                            const leaderBonusPool = await web3.contract.leaderBonusPoolBalance();

                            setContractStats({
                                totalUsers: totalUsers.toNumber(),
                                totalVolume: ethers.utils.formatUnits(totalVolume, 6),
                                globalHelpPool: ethers.utils.formatUnits(globalHelpPool, 6),
                                leaderBonusPool: ethers.utils.formatUnits(leaderBonusPool, 6)
                            });

                        } catch (error) {
                            console.error('Error loading user data:', error);
                            addNotification('Error loading user data: ' + error.message, 'error');
                        } finally {
                            setLoading(false);
                        }
                    }
                };

                loadUserData();
            }, [web3.isConnected, web3.contract, web3.account]);

            // Handle user registration
            const handleRegisterUser = async () => {
                if (!web3.isConnected || !web3.contract) {
                    addNotification('Please connect your wallet first', 'warning');
                    return;
                }

                if (!registrationForm.sponsor || !ethers.utils.isAddress(registrationForm.sponsor)) {
                    addNotification('Please enter a valid sponsor address', 'error');
                    return;
                }

                setLoading(true);
                try {
                    const tx = await web3.contract.registerUser(
                        registrationForm.sponsor,
                        registrationForm.packageTier
                    );
                    
                    addNotification('Registration transaction sent! Waiting for confirmation...', 'info');
                    await tx.wait();
                    
                    addNotification('Registration successful! Welcome to OrphiChain!', 'success');
                    
                    // Reload user data
                    setTimeout(() => {
                        window.location.reload();
                    }, 2000);
                    
                } catch (error) {
                    console.error('Registration error:', error);
                    addNotification('Registration failed: ' + error.message, 'error');
                } finally {
                    setLoading(false);
                }
            };

            // Handle withdrawal
            const handleWithdraw = async (amount) => {
                if (!web3.isConnected || !web3.contract) {
                    addNotification('Please connect your wallet first', 'warning');
                    return;
                }

                setLoading(true);
                try {
                    const amountWei = ethers.utils.parseUnits(amount.toString(), 6);
                    const tx = await web3.contract.withdraw(amountWei);
                    
                    addNotification('Withdrawal transaction sent! Waiting for confirmation...', 'info');
                    await tx.wait();
                    
                    addNotification('Withdrawal successful!', 'success');
                    
                    // Reload user data
                    setTimeout(() => {
                        window.location.reload();
                    }, 2000);
                    
                } catch (error) {
                    console.error('Withdrawal error:', error);
                    addNotification('Withdrawal failed: ' + error.message, 'error');
                } finally {
                    setLoading(false);
                }
            };

            // Format address for display
            const formatAddress = (address) => {
                if (!address) return 'N/A';
                return `${address.slice(0, 6)}...${address.slice(-4)}`;
            };

            // Get package name
            const getPackageName = (tier) => {
                const packages = {
                    1: '$30 Entry',
                    2: '$50 Standard', 
                    3: '$100 Advanced',
                    4: '$200 Premium'
                };
                return packages[tier] || 'Unknown';
            };

            // Get rank name
            const getRankName = (rank) => {
                const ranks = {
                    0: 'None',
                    1: 'Shining Star',
                    2: 'Silver Star'
                };
                return ranks[rank] || 'Unknown';
            };

            return React.createElement('div', { className: 'ultimate-dashboard' },
                // Notifications
                React.createElement('div', { className: 'notifications-container' },
                    notifications.map(notification =>
                        React.createElement('div', {
                            key: notification.id,
                            className: `notification ${notification.type}`,
                            onClick: () => removeNotification(notification.id)
                        }, notification.message)
                    )
                ),

                // Header
                React.createElement('header', { className: 'dashboard-header' },
                    React.createElement('div', { className: 'header-left' },
                        React.createElement('div', { className: 'logo' }, 'ðŸš€'),
                        React.createElement('h1', { className: 'dashboard-title' }, 'OrphiChain Live Dashboard')
                    ),
                    React.createElement('div', { className: 'header-right' },
                        React.createElement('div', { className: 'status-badges' },
                            React.createElement('div', { className: 'badge connected' }, 'âœ… BSC Mainnet'),
                            React.createElement('div', { className: 'badge live' }, 'ðŸ”´ Live Data'),
                            web3.isConnected && React.createElement('div', { className: 'badge success' }, 'ðŸ”— Connected')
                        ),
                        React.createElement('div', { className: 'wallet-info' },
                            web3.isConnected ? 
                                React.createElement('span', { className: 'wallet-address' }, formatAddress(web3.account)) :
                                React.createElement('button', { 
                                    className: 'connect-wallet-btn',
                                    onClick: web3.connectWallet
                                }, 'Connect Wallet')
                        )
                    )
                ),

                // Main Container
                React.createElement('div', { className: 'dashboard-container' },
                    // Connection Status
                    !web3.isConnected && React.createElement('div', { className: 'contract-info' },
                        React.createElement('h2', { className: 'section-title' },
                            React.createElement('span', null, 'ðŸ”—'),
                            'Connect Your Wallet'
                        ),
                        React.createElement('p', { style: { color: 'var(--orphi-text-secondary)', marginBottom: '1rem' } },
                            'Connect your MetaMask wallet to interact with the OrphiChain platform on BSC Mainnet.'
                        ),
                        React.createElement('button', { 
                            className: 'action-btn',
                            onClick: web3.connectWallet
                        }, 'ðŸ”— Connect MetaMask')
                    ),

                    // User Registration (if not registered)
                    web3.isConnected && !userInfo && React.createElement('div', { className: 'user-registration' },
                        React.createElement('h2', { className: 'section-title' },
                            React.createElement('span', null, 'ðŸ“'),
                            'Register on OrphiChain'
                        ),
                        React.createElement('p', { style: { color: 'var(--orphi-text-secondary)', marginBottom: '2rem' } },
                            'Join the OrphiChain platform and start earning with our compensation plan.'
                        ),
                        React.createElement('div', { className: 'registration-form' },
                            React.createElement('div', { className: 'form-group' },
                                React.createElement('label', { className: 'form-label' }, 'Sponsor Address'),
                                React.createElement('input', {
                                    type: 'text',
                                    className: 'form-input',
                                    placeholder: '0x...',
                                    value: registrationForm.sponsor,
                                    onChange: (e) => setRegistrationForm(prev => ({ ...prev, sponsor: e.target.value }))
                                })
                            ),
                            React.createElement('div', { className: 'form-group' },
                                React.createElement('label', { className: 'form-label' }, 'Select Package'),
                                React.createElement('div', { className: 'package-options' },
                                    [30, 50, 100, 200].map(amount => 
                                        React.createElement('div', {
                                            key: amount,
                                            className: `package-option ${registrationForm.packageTier === PACKAGE_TIERS[`PACKAGE_${amount}`] ? 'selected' : ''}`,
                                            onClick: () => setRegistrationForm(prev => ({ ...prev, packageTier: PACKAGE_TIERS[`PACKAGE_${amount}`] }))
                                        },
                                            React.createElement('div', { className: 'package-amount' }, `$${amount}`),
                                            React.createElement('div', { className: 'package-name' }, 
                                                amount === 30 ? 'Entry' : 
                                                amount === 50 ? 'Standard' : 
                                                amount === 100 ? 'Advanced' : 'Premium'
                                            )
                                        )
                                    )
                                )
                            ),
                            React.createElement('button', {
                                className: 'action-btn',
                                onClick: handleRegisterUser,
                                disabled: loading
                            }, loading ? 'Registering...' : 'ðŸš€ Register Now')
                        )
                    ),

                    // User Dashboard (if registered)
                    web3.isConnected && userInfo && React.createElement(React.Fragment, null,
                        // Main Metrics
                        React.createElement('div', { className: 'main-metrics' },
                            React.createElement('div', { className: 'metric-card' },
                                loading && React.createElement('div', { className: 'loading-overlay' },
                                    React.createElement('div', { className: 'loading-content' },
                                        React.createElement('div', { className: 'loading-spinner' }),
                                        React.createElement('p', null, 'Loading...')
                                    )
                                ),
                                React.createElement('div', { className: 'metric-header' },
                                    React.createElement('div', { className: 'metric-title' },
                                        React.createElement('span', { className: 'metric-icon' }, 'ðŸ’°'),
                                        'Total Earnings'
                                    )
                                ),
                                React.createElement('div', { className: 'metric-value' }, `$${parseFloat(userInfo.totalEarnings).toFixed(2)}`),
                                React.createElement('div', { className: 'metric-subtitle' }, 'Lifetime earnings from all pools'),
                                React.createElement('div', { className: 'metric-trend trend-positive' }, 'â†—ï¸ Real-time data')
                            ),
                            React.createElement('div', { className: 'metric-card' },
                                React.createElement('div', { className: 'metric-header' },
                                    React.createElement('div', { className: 'metric-title' },
                                        React.createElement('span', { className: 'metric-icon' }, 'ðŸ’³'),
                                        'Withdrawable'
                                    )
                                ),
                                React.createElement('div', { className: 'metric-value' }, `$${parseFloat(userInfo.withdrawableAmount).toFixed(2)}`),
                                React.createElement('div', { className: 'metric-subtitle' }, `${(userInfo.withdrawalRate * 100).toFixed(0)}% withdrawal rate`),
                                React.createElement('div', { className: 'metric-trend trend-positive' }, 'â†—ï¸ Available now')
                            ),
                            React.createElement('div', { className: 'metric-card' },
                                React.createElement('div', { className: 'metric-header' },
                                    React.createElement('div', { className: 'metric-title' },
                                        React.createElement('span', { className: 'metric-icon' }, 'ðŸ‘¥'),
                                        'Team Size'
                                    )
                                ),
                                React.createElement('div', { className: 'metric-value' }, userInfo.teamSize),
                                React.createElement('div', { className: 'metric-subtitle' }, `${userInfo.directReferrals} direct referrals`),
                                React.createElement('div', { className: 'metric-trend trend-positive' }, 'â†—ï¸ Growing network')
                            ),
                            React.createElement('div', { className: 'metric-card' },
                                React.createElement('div', { className: 'metric-header' },
                                    React.createElement('div', { className: 'metric-title' },
                                        React.createElement('span', { className: 'metric-icon' }, 'â­'),
                                        'Current Rank'
                                    )
                                ),
                                React.createElement('div', { className: 'metric-value' }, getRankName(userInfo.leaderRank)),
                                React.createElement('div', { className: 'metric-subtitle' }, getPackageName(userInfo.packageTier)),
                                React.createElement('div', { className: 'metric-trend trend-positive' }, userInfo.isActive ? 'âœ… Active' : 'âŒ Inactive')
                            )
                        ),

                        // Action Buttons
                        React.createElement('div', { className: 'action-section' },
                            React.createElement('h2', { className: 'section-title' },
                                React.createElement('span', null, 'âš¡'),
                                'Quick Actions'
                            ),
                            React.createElement('div', { className: 'action-buttons' },
                                React.createElement('button', {
                                    className: 'action-btn',
                                    onClick: () => handleWithdraw(userInfo.withdrawableAmount),
                                    disabled: loading || parseFloat(userInfo.withdrawableAmount) === 0
                                }, `ðŸ’¸ Withdraw $${parseFloat(userInfo.withdrawableAmount).toFixed(2)}`),
                                React.createElement('button', {
                                    className: 'action-btn secondary',
                                    onClick: () => window.open(CONTRACT_CONFIG.contractUrl, '_blank')
                                }, 'ðŸ“‹ View Contract'),
                                React.createElement('button', {
                                    className: 'action-btn secondary',
                                    onClick: () => window.location.reload()
                                }, 'ðŸ”„ Refresh Data')
                            )
                        )
                    ),

                    // Contract Information
                    React.createElement('div', { className: 'contract-info' },
                        React.createElement('h2', { className: 'section-title' },
                            React.createElement('span', null, 'ðŸ“‹'),
                            'Contract Information'
                        ),
                        React.createElement('div', { className: 'contract-details' },
                            React.createElement('div', { className: 'contract-item' },
                                React.createElement('span', { className: 'contract-label' }, 'Contract Address:'),
                                React.createElement('span', { className: 'contract-value' }, CONTRACT_CONFIG.address)
                            ),
                            React.createElement('div', { className: 'contract-item' },
                                React.createElement('span', { className: 'contract-label' }, 'Network:'),
                                React.createElement('span', { className: 'contract-value' }, CONTRACT_CONFIG.network)
                            ),
                            React.createElement('div', { className: 'contract-item' },
                                React.createElement('span', { className: 'contract-label' }, 'Status:'),
                                React.createElement('span', { className: 'status-live' }, 'Live & Active')
                            ),
                            contractStats && React.createElement('div', { className: 'contract-item' },
                                React.createElement('span', { className: 'contract-label' }, 'Total Users:'),
                                React.createElement('span', { className: 'contract-value' }, contractStats.totalUsers.toLocaleString())
                            ),
                            contractStats && React.createElement('div', { className: 'contract-item' },
                                React.createElement('span', { className: 'contract-label' }, 'Total Volume:'),
                                React.createElement('span', { className: 'contract-value' }, `$${parseFloat(contractStats.totalVolume).toLocaleString()}`)
                            ),
                            contractStats && React.createElement('div', { className: 'contract-item' },
                                React.createElement('span', { className: 'contract-label' }, 'Global Help Pool:'),
                                React.createElement('span', { className: 'contract-value' }, `$${parseFloat(contractStats.globalHelpPool).toFixed(2)}`)
                            )
                        )
                    )
                )
            );
        };

        // Render the dashboard
        ReactDOM.render(React.createElement(OrphiChainMainnetDashboard), document.getElementById('root'));
    </script>
</body>
</html>
